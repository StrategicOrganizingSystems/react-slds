'use strict';exports.__esModule=true;exports.Item=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=require('react');var _react2=_interopRequireDefault(_react);var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=require('lodash');var _Svg=require('./components/Svg');var _Svg2=_interopRequireDefault(_Svg);var _utils=require('./utils');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}// add later
// Displaying Options Based On User Input
var LookupId='-id-'+(0,_lodash.uniqueId)();/* Icon for Item */var Icon=function Icon(props){if(props.variant!==''||props.icon!==''){return _react2.default.createElement(_Svg2.default,{className:'slds-icon slds-icon_small',variant:props.variant,icon:props.icon})}return null};/* Item */var Item=exports.Item=function Item(props){function markText(string,mark){if(mark!==null&&mark.trim().length>0){var strArr=string.split(new RegExp('('+mark+')','ig'));return strArr.map(function(ea,i){if(ea.toLowerCase()===mark.toLowerCase()){return _react2.default.createElement('mark',{key:'match'+i},ea)}return ea})}return string}var id='option-'+props.index;var className=(0,_utils.createClassName)('slds-media','slds-listbox__option','slds-listbox__option_entity','slds-listbox__option_has-meta',props.hasFocus?'slds-has-focus':'');var children=props.children;if(props.mark!==null&&props.mark.trim()!==''){children=markText(children,props.mark)}// eslint-disable-next-line
return _react2.default.createElement('li',{role:'presentation',className:'slds-listbox__item',onClick:function onClick(e){return props.onClick(e,props.index)}},_react2.default.createElement('div',{id:id,className:className,role:'option'},_react2.default.createElement('span',{className:'slds-media__figure'},_react2.default.createElement('span',{className:'slds-icon_container slds-icon-standard-account'},_react2.default.createElement(Icon,{variant:props.variant,icon:props.icon}))),_react2.default.createElement('span',{className:'slds-media__body'},_react2.default.createElement('span',{className:'slds-listbox__option-text slds-listbox__option-text_entity'},children),_react2.default.createElement('span',{className:'slds-listbox__option-meta slds-listbox__option-meta_entity'},props.meta))))};//         <input type="radio" name={`radio${LookupId}`} id={`radio-${id}`}  />
Item.defaultProps={variant:'',icon:'',onClick:function onClick(){}};Item.propTypes={// children: PropTypes.isRequired,
meta:_propTypes2.default.string,variant:_propTypes2.default.string.isRequired,icon:_propTypes2.default.string.isRequired};/* Icon Right for Selected Item */var IconRight=function IconRight(props){if(props.show&&(props.variant!==''||props.icon!=='')){var assText=props.assistiveText||(0,_lodash.startCase)((0,_lodash.camelCase)(props.icon));return _react2.default.createElement('span',{className:'slds-icon_container slds-icon-standard-account slds-combobox__input-entity-icon',title:assText},_react2.default.createElement(_Svg2.default,{className:'slds-icon slds-icon_small',variant:props.variant,icon:props.icon}),_react2.default.createElement('span',{className:'slds-assistive-text'},assText))}return null};IconRight.defaultProps={assistiveText:''};IconRight.propTypes={assistiveText:_propTypes2.default.string};/* Icon Left  */var IconLeft=function IconLeft(props){var variant=props.variant,icon=props.icon;if(props.withValue){return _react2.default.createElement('button',{className:'slds-button slds-button_icon slds-input__icon slds-input__icon_right',onClick:function onClick(e){return props.onClick(e)},title:'Remove selected option'},_react2.default.createElement(_Svg2.default,{className:'slds-button__icon',variant:'utility',icon:'close',assistiveText:'Remove selected option'}))}var className=(0,_utils.createClassName)('slds-icon_container','slds-icon-'+variant+'-'+icon,'slds-input__icon','slds-input__icon_right');return _react2.default.createElement('span',{className:className},_react2.default.createElement(_Svg2.default,{className:'slds-icon slds-icon slds-icon_x-small slds-icon-text-default',variant:variant,icon:icon}));return null};IconLeft.defaultProps={assistiveText:'Search',variant:'utility',icon:'search',onClick:function onClick(){}};IconLeft.propTypes={assistiveText:_propTypes2.default.string};var Lookup=function(_Component){_inherits(Lookup,_Component);function Lookup(){var _temp,_this,_ret;_classCallCheck(this,Lookup);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,_Component.call.apply(_Component,[this].concat(args))),_this),_this.state={itemIndex:-1},_this.onKeyUp=function(e,cb){var code=e.keyCode;var itemIndex=_this.state.itemIndex;var Items=_react2.default.Children.toArray(_this.props.children).filter(function(c){return c.type===Item});var numOfChild=Items.length;if(code===40){++itemIndex;if(itemIndex>=numOfChild){itemIndex=0}}if(code===38){if(itemIndex===null){itemIndex=numOfChild-1}else{--itemIndex;if(itemIndex<0){itemIndex=numOfChild-1}}}_this.setState({itemIndex:itemIndex});if(code===13){return cb(e,itemIndex)}},_temp),_possibleConstructorReturn(_this,_ret)}// shouldComponentUpdate(nextProps, nextState) {
//   if(nextState.itemIndex !== this.state.itemIndex){
//     return false;
//   }
//   return true;
//
// }
Lookup.prototype.render=function render(){var _this2=this;var props=this.props;var itemIndex=this.state.itemIndex;var id=LookupId;var isValidValue=(0,_utils.isDefined)(props.selectedValue)&&props.selectedValue!==null&&props.selectedValue.length;var containerClass=(0,_utils.createClassName)('slds-combobox_container',isValidValue?'slds-has-selection':'');var comboboxClass=(0,_utils.createClassName)('slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click',props.isOpen?'slds-is-open':'');var inputClass=(0,_utils.createClassName)('slds-input','slds-combobox__input',isValidValue?'slds-combobox__input-value':'',props.isOpen?'slds-has-focus':'');var formElementClass=(0,_utils.createClassName)('slds-combobox__form-element','slds-input-has-icon',isValidValue?'slds-input-has-icon_left-right':'slds-input-has-icon_right');// console.log(props.value);
var inputElem=void 0;var extraInputProps={value:props.mark};if(isValidValue){extraInputProps={readOnly:true,value:props.selectedValue}}// eslint-disable-next-line 
return _react2.default.createElement('div',{className:'cc-slds-lookup',style:props.style},_react2.default.createElement('div',{className:'slds-form-element'},_react2.default.createElement('label',{className:'slds-form-element__label',htmlFor:'combobox'+id},props.label),_react2.default.createElement('div',{className:'slds-form-element__control'},_react2.default.createElement('div',{className:containerClass},_react2.default.createElement('div',{className:comboboxClass,'aria-expanded':props.isOpen,'aria-haspopup':'listbox',role:'combobox'},_react2.default.createElement('div',{className:formElementClass,role:'none'},_react2.default.createElement(IconRight,{show:isValidValue,assistiveText:props.assistiveText,variant:props.variant,icon:props.icon}),_react2.default.createElement('input',_extends({type:'text',className:inputClass,id:'combobox'+id,'aria-autocomplete':'list','aria-controls':'listbox'+id,autoComplete:'off',role:'textbox',placeholder:props.placeHolder,onChange:function onChange(e){return props.onChange(e)},onKeyUp:function onKeyUp(e){return _this2.onKeyUp(e,props.onEnter)}},extraInputProps)),_react2.default.createElement(IconLeft,{withValue:isValidValue,onClick:function onClick(e){return props.onRemoveSelected(e)}})),_react2.default.createElement('div',{id:'listbox'+id,className:'slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid',role:'listbox'},_react2.default.createElement('ul',{className:'slds-listbox slds-listbox_vertical',role:'presentation'},_react2.default.Children.toArray(props.children).filter(function(c){return c.type===Item}).map(function(n,i){return _react2.default.cloneElement(n,_extends({},n.props,{hasFocus:itemIndex===i,mark:props.mark,index:i}))}))))))))};return Lookup}(_react.Component);Lookup.defaultProps={style:{},placeHolder:'',onChange:function onChange(){},onEnter:function onEnter(){},onRemoveSelected:function onRemoveSelected(){},mark:null};Lookup.propTypes={label:_propTypes2.default.string.isRequired,placeHolder:_propTypes2.default.string.isRequired};exports.default=Lookup;